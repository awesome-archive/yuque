# 编辑器 2.4 发布说明

为了解决可视化编辑过程中遇到的光标、选区、删除等常见问题，也为了提升一些插件但编写体验，我们对编辑器进行一次重大的升级。编辑器一直在持续的优化中，本次更新将升级到 2.4 版本。

# 01 图片、附件、视频等文件元素支持光标聚焦

__文件元素__是指编辑过程中，没有文本输入的文档内容。常见的元素有：图片、附件、视频、分割线等。而当这些元素彼此之间相邻的时候，就会遇到无法在其中间输入内容的问题。为了解决这个问题，我们尝试在这些元素左右位置加入光标的支持，以满足正常的聚焦、输入等能力，详见下面示例图：
![Kapture 2018-04-03 at 12.37.21.gif | left | 748x217](https://cdn.yuque.com/lark/2018/gif/1/1522730271525-6971ce53-fd4e-414b-8002-70a485830723.gif "")

__同时调整__：通过键盘__删除键__回删字符时，遇到文件元素会先聚焦到该节点，并且选中改节点，这时候再按删除键才会删除。

# 02 组件工具栏调整

我们统一了__链接__、__图片__、__附件__、__视频__等的工具栏交互方式，由原先的上浮模式更新为组件下沉。组件工具栏的样式和操作风格基本保持一致，工具栏效果如下:![image.png | center | 374.3x190](https://cdn.yuque.com/lark/2018/png/1/1522381694731-a8b43d64-d4f4-45ca-bcf1-997478b0bf84.png "")

# 03 块级节点支持拖动及更多菜单功能

常用的__块级节点__有标题、图片、附件、视频、分割线、代码块等。这些节点输入之后排序是一个难题，为此我们在这些几点左上角加入__拖拽__区域，你可以通过该区域触发拖动节点进行排序。

同时，我们在该拖放区域增加了点击事件，点击之后可以弹出菜单浮层。在这个菜单中会有克隆、拷贝锚点、编辑锚点和删除节点功能。![image.png | center | 200x170](https://cdn.yuque.com/lark/2018/png/1/1522382231578-039977e6-348a-4ba6-88dd-10e2ca0c634e.png "")

锚点功能可以帮助我们通过链接地址的 Hash 值自动滚动到该节点位置。我们会默认生成一个 6 位字符的锚点，但如果需要，你也可行进行编辑。

__同时调整__：已有的文档中的标题会生成新的锚点，不再以标题内容生成。但为了兼容老的 URL，我们会保留该标题的锚点位置（也就是说之前 URL 中包含的锚点不需要修改），会定位到该位置。

# 04 图片组件升级

图片由原来的__块级模式__调整为__行内模式__。但展示形式依旧支持块级和行内两种。不同的表现在于：行内模式为文本环绕模式，直接嵌入到文本内容中，例如这个表情图片![1f914.png | center | 24x24](https://cdn.yuque.com/lark/2018/png/1/1522381081864-ec73340d-c491-44ae-a514-6c89dd498df0.png "")；块级模式为独占一行模式，不会有文本左右环绕。

详见下面操作：

[embed: Kapture 2018-04-03 at 12.30.01.mp4](https://yuque.com/attachments/yuque/2018/mp4/84179/1522813544904-900d901c-87f7-44b7-87cb-94ded9cd5272.mp4 "align:center")


* __调整图片上传交互逻辑__。点击工具栏图片按钮，会先占位再选择图片上传。同时支持拖拽图片上传和粘贴板图片上传。
* __调整图片尺寸调整逻辑__。选中图片之后，可以通过四个角等触发点来拖动修改图片大小，也可以通过输入数值来精确控制图片尺寸。
* __调整图片对齐逻辑__。选中图片之后，可以对独占一行的图片调整对齐方式。

# 05 数学公式所编即所得

数学公式正式作为一种内容类型加入到编辑器中。我们新增『__实验室__』菜单，将会在这里面提供现阶段还在完善的一些能力。<div id="na4dtc" data-type="math" data-display="block" data-align="center" data-src="https://cdn.yuque.com/__latex/e36082a658861cb7b69379914c9ac04a.svg" data-text="x%20%3D%20%7B-b%20%5Cpm%20%5Csqrt%7Bb%5E2-4ac%7D%20%5Cover%202a%7D." data-width="163" data-height="46"><img src="https://cdn.yuque.com/__latex/e36082a658861cb7b69379914c9ac04a.svg" width="163"/></div>
目前采用[ KaTex](https://khan.github.io/KaTeX/) 库生成 *LaTeX *数学公式，因此有一个门槛是你需要熟知一点 LaTeX 语法，编辑公式源码之后即可生存在线的公式效果。

更多关于公式编辑的介绍详见 [数学公式](/help/editor-math) 。

# 06 PlantUML 图例

[PlantUML](http://plantuml.com)__ __是一个开源项目，支持快速绘制时序图、用例图、类图、活动图、组件图、状态图、对象图、部署图等。同时还支持非 UML 图的甘特图、架构图等。例如下面等用例图：

<div id="xhczgg" data-type="puml" data-display="block" data-align="center" data-src="https://cdn.yuque.com/__puml/84bf1d214143ce16607bc50aba43704a.svg" data-width="360" data-height="336" data-text="%40startuml%0A%0Aactor%20C%0Aactor%20B%0A%0AA%20-up-%3E%20(up)%0AA%20-right-%3E%20(center)%0AA%20-down-%3E%20(down)%0AA%20-left-%3E%20(left)%0A%0AB%20-up-%3E%20(up)%0AB%20-left-%3E%20(center)%0AB%20-right-%3E%20(right)%0AB%20-down-%3E%20(down)%0A%0A%40enduml"><img src="https://cdn.yuque.com/__puml/84bf1d214143ce16607bc50aba43704a.svg" width="360"/></div>


我们也在本次升级引入了 PlantUML 的所见即所得编辑。可以在『__实验室__』菜单中找到 PlantUML 子菜单并且点击插入到文档中。为了方便快速入手，我们还提供几个简单的模板供你使用。

更多关于 PlantUML 编辑的介绍详见 [Plant UML](/help/editor-puml) 。

# 其他

除了以上功能之外，我们还修正了部分基础问题，例如：剪切、复制与拷贝问题等。

